# admin总结

有人觉得前端框架不断推陈出新增加了前端开发的门槛，其实我倒是觉得这种所谓`mvvm`的框架出现，极大的降低了前端开发的门槛，但是提升了从业人员对于工程化开发思路的门槛。所以用`vue`开发只要注意如何维护好对应的数据，就能基本搞定。所以，最最重要的还是基础，特别是css布局没搞明白，能折腾半天。

## admin难点

这边的主要难点几种在几点上面。第一就是登陆权限的控制，`vuex`状态设计，以及`simpleMDE``三方插件的引入。

## 登陆权限

### 请求控制

这个是要和后端配合起来，这里我和后端约定好，我的请求里面把cookie都给带上，cookie中带有token。`koa`在有需要登陆的controller处先设置一层登陆校验，拿到前端给的token对比一下，没有问题就`next`到业务`controller`，如果出现验证失败，那就返回一个*401*，那我在页面出用`axios`的请求拦截器进行返回拦截，发现是`401`的返回值，我也就知道是登陆有问题了，直接重定向到登陆页面。

### 页面控制

这里需要注意一下，`vue-router`里面有一个路由守卫的概念，其实就是监听路由变化的事件，所以在需要有登陆权限才能访问的页面实质上需要配合`vue-router`的一个`beforeEach`的钩子函数，跳到一个需要权限的页面之前，我先去给后端发一个校验是否登陆的请求，请求成功后才跳页面，否则就跳登陆页面。这里有一个小小的点需要提一下，当初这里也被绕进去了，就是后端在`check`这个校验是否登陆的`controller`的时候，如果鉴权失败是不能像其他`controller`返回一个`401`的，不然这个返回的401又被`axios`拦截，会造成问题，这里是否成功，都应该返回200。

## vuex设计

顶层store如何设计见仁见智，但是一个好的store结构设计，确实给后面具体页面组件调用的时候相当地方便。

## 三方库的使用

第三方库的接入，特别是那种不是`Vue`组件写法的组件，而更像是原来那种`js`原生写法的组件，引入这种`mvvm`库还是有挺多小问题的，要特别注意组件销毁的时候移除这种组件。